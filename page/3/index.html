<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="Geek Liao">
<meta property="og:url" content="http://changzeng.github.io/page/3/index.html">
<meta property="og:site_name" content="Geek Liao">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Geek Liao">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://changzeng.github.io/page/3/"/>





  <title>Geek Liao</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Geek Liao</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/26/新词发现算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/26/新词发现算法/" itemprop="url">新词发现算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-26T14:42:57+08:00">
                2018-01-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NLP/" itemprop="url" rel="index">
                    <span itemprop="name">NLP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/25/tensorflow单机多gpu并行计算/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/25/tensorflow单机多gpu并行计算/" itemprop="url">tensorflow单机多gpu并行计算</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-25T15:17:38+08:00">
                2018-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tensorflow/" itemprop="url" rel="index">
                    <span itemprop="name">tensorflow</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>TensorFlow可以可以利用GPU加速深度学习模型的训练过程，在这里介绍一下利用多个GPU或者机器时，TensorFlow是如何进行多GPU并行计算的。<br>首先，TensorFlow并行计算分为：模型并行，数据并行。模型并行是指根据不同模型设计不同的并行方式，模型不同计算节点放在不同GPU或者机器上进行计算。数据并行是比较通用简便的实现大规模并行方式，同时使用多个硬件资源计算不同batch数据梯度，汇总梯度进行全局参数更新。<br>在这里我们主要介绍数据并行的多GPU并行方法。数据并行，多块GPU同时训练多个batch数据，运行在每块GPU上的模型基于同一神经网络，网络结构一样，共享模型参数。数据并行也分为两个部分，同步数据并行和异步数据并行。<br>在每一轮迭代中，前向传播算法会根据当前参数的取值，计算出在一小部分训练数据上的预测值，然后反向传播算法，根据loss function计算参数的梯度并且更新参数。而不同的数据并行模式的区别在于参数的更新方式不同。 </p>
<h3 id="数据异步并行"><a href="#数据异步并行" class="headerlink" title="数据异步并行"></a>数据异步并行</h3><center><img src="/img/posts/shujuyibu_bingxing.jpeg" alt=""></center>

<p>从图一可以看出，在每一轮迭代时候，不同的设备会读取参数最新的取值。但是因为不同的设备，读取参数取值的时间不一样，得到的值也有可能不一样。<br>也就是说数据异步并行模式根据当前参数的取值和随机获取的一小部分数据数据在不同设备上各自运行，不等待所有GPU完成一次训练，哪个GPU完成训练，立即将梯度更新到共享模型参数。 </p>
<h3 id="数据同步并行"><a href="#数据同步并行" class="headerlink" title="数据同步并行"></a>数据同步并行</h3><center><img src="/img/posts/shujutongbu_bingxing.jpeg" alt=""></center>

<p>与数据异步并行模式不同的是数据同步并行模式在所有设备完成反向传播的计算之后，需要计算出不同设备上参数梯度的平均值，最后在根据平均值对参数进行更新。 </p>
<h3 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h3><p>同步数据并行，所有GPU计算完batch数据梯度，统计将多个梯度合在一起，更新共享模型参数，类似使用较大batch。GPU型号、速度一致时，效率最高。<br>异步数据并行，不等待所有GPU完成一次训练，哪个GPU完成训练，立即将梯度更新到共享模型参数。<br>同步数据并行比异步收敛速度更快，模型精度更高。 </p>
<h3 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h3><ol>
<li><a href="https://gitee.com/liyang619/mnist_multi_gpu_batching_train/blob/master/mnist_multi_gpu_batching_train.py" target="_blank" rel="noopener">TensorFlow多GPU并行计算实例—MNIST</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/25/tensorflow模型并行和数据并行/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/25/tensorflow模型并行和数据并行/" itemprop="url">tensorflow数据并行和模型并行</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-25T15:06:15+08:00">
                2018-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tensorflow/" itemprop="url" rel="index">
                    <span itemprop="name">tensorflow</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="数据并行"><a href="#数据并行" class="headerlink" title="数据并行"></a>数据并行</h3><p>一个简单的加速训练的技术是并行地计算梯度，然后更新相应的参数。数据并行又可以根据其更新参数的方式分为同步数据并行和异步数据并行，同步的数据并行方式如图所示，tensorflow图有着很多的部分图模型计算副本，单一的客户端线程驱动整个训练图，来自不同的设备的数据需要进行同步更新。这种方式在实现时，主要的限制就是每一次更新都是同步的，其整体计算时间取决于性能最差的那个设备。 </p>
<center><img src="/img/posts/data_parallelism" alt=""></center>

<p>数据并行还有异步的实现方式，如图所示，与同步方式不同的是，在处理来自不同设备的数据更新时进行异步更新，不同设备之间互不影响，对于每一个图副本都有一个单独的客户端线程与其对应。在这样的实现方式下，即使有部分设备性能特别差甚至中途退出训练，对训练结果和训练效率都不会造成太大影响。但是由于设备间互不影响，所以在更新参数时可能其他设备已经更好的更新过了，所以会造成参数的抖动，但是整体的趋势是向着最好的结果进行的。所以说这种方式更适用于数据量大，更新次数多的情况。</p>
<center><img src="/img/posts/data_parallelism_asynchronous" alt=""></center>

<h3 id="模型并行"><a href="#模型并行" class="headerlink" title="模型并行"></a>模型并行</h3><p>一个模型并行训练的例子如图所示，其针对的训练对象是同一批样本数据，但是将不同的模型计算部分分布在不同的计算设备上同时执行。 </p>
<center><img src="/img/posts/model_parallelism" alt=""></center>

<h3 id="模型计算流水线并行"><a href="#模型计算流水线并行" class="headerlink" title="模型计算流水线并行"></a>模型计算流水线并行</h3><p>此并行方式主要针对在同一个设备中并发实现模型的计算，如图是其并发计算步骤，可以发现它实际上与异步数据并行有些相似，但是唯一不同的是此方式的并行发生在同一个设备上，而不是在不同的设备之间。并且在计算一批简单的样例时，允许进行“填充间隙”，这可以充分利用空闲的设备资源。 </p>
<center><img src="/img/posts/client_parallelism" alt=""></center>

<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ol>
<li><a href="http://blog.csdn.net/u010510350/article/details/53412659" target="_blank" rel="noopener">Tensorflow分布式并行策略</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/25/分布式tensorflow/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/25/分布式tensorflow/" itemprop="url">分布式tensorflow</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-25T14:42:11+08:00">
                2018-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tensorflow/" itemprop="url" rel="index">
                    <span itemprop="name">tensorflow</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Cluster、Job、Task"><a href="#Cluster、Job、Task" class="headerlink" title="Cluster、Job、Task"></a>Cluster、Job、Task</h3><h5 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h5><p>主机上的一个进程，一般一台机器上只运行一个进程。</p>
<h5 id="Job"><a href="#Job" class="headerlink" title="Job"></a>Job</h5><p>job是task的集合。在分布式深度学习框架中,我们一般把<code>Job</code>划分为<code>Parameter</code>和<code>Worker</code>,<code>Parameter Job</code>是管理参数的存储和更新工作.<code>Worker Job</code>是来运行<code>ops</code>.如果参数的数量太大,一台机器处理不了,这就要需要多个<code>Tasks</code>。</p>
<h5 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a>Cluster</h5><p><code>Cluster</code> 是 <code>Jobs</code> 的集合: <code>Cluster</code>(集群),就是我们用的集群系统了。</p>
<h3 id="如何创建集群"><a href="#如何创建集群" class="headerlink" title="如何创建集群"></a>如何创建集群</h3><p>从上面的描述我们可以知道,组成<code>Cluster</code>的基本单位是<code>Task</code>(动态上理解,主机上的一个进程,从静态的角度理解,<code>Task</code>就是我们写的代码).我们只需编写<code>Task</code>代码,然后将代码运行在不同的主机上,这样就构成了<code>Cluster</code>(集群)</p>
<h3 id="如何编写Task代码"><a href="#如何编写Task代码" class="headerlink" title="如何编写Task代码"></a>如何编写<code>Task</code>代码</h3><p>首先,<code>Task</code>需要知道集群上都有哪些主机,以及它们都监听什么端口.<code>tf.train.ClusterSpec()</code>就是用来描述这个.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tf.train.ClusterSpec(&#123;</span><br><span class="line">    <span class="string">"worker"</span>: [</span><br><span class="line">        <span class="string">"worker_task0.example.com:2222"</span>,<span class="comment"># /job:worker/task:0 运行的主机</span></span><br><span class="line">        <span class="string">"worker_task1.example.com:2222"</span>,<span class="comment"># /job:worker/task:1 运行的主机</span></span><br><span class="line">        <span class="string">"worker_task2.example.com:2222"</span><span class="comment"># /job:worker/task:3 运行的主机</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"ps"</span>: [</span><br><span class="line">        <span class="string">"ps_task0.example.com:2222"</span>,  <span class="comment"># /job:ps/task:0 运行的主机</span></span><br><span class="line">        <span class="string">"ps_task1.example.com:2222"</span>   <span class="comment"># /job:ps/task:0 运行的主机</span></span><br><span class="line">    ]&#125;)</span><br></pre></td></tr></table></figure>
<p>这个<code>ClusterSec</code>告诉我们,我们这个<code>Cluster</code>(集群)有两个<code>Job</code>(worker.ps),<code>worker</code>中有三个<code>Task</code>(即,有三个<code>Task</code>执行<code>Tensorflow op</code>操作)</p>
<p>然后,将<code>ClusterSpec</code>当作参数传入到 <code>tf.train.Server()</code>中,同时指定此<code>Task</code>的<code>Job_name</code>和<code>task_index</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#jobName和taskIndex是函数运行时,通过命令行传递的参数</span></span><br><span class="line">server = tf.train.Server(cluster, job_name=jobName, task_index=taskIndex)</span><br></pre></td></tr></table></figure>
<p>下面代码描述的是,一个<code>cluster</code>中有一个<code>Job,</code>叫做(<code>worker</code>), 这个<code>job</code>有两个<code>task</code>,这两个<code>task</code>是运行在两个主机上的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在主机(10.1.1.1)上,实际是运行以下代码</span></span><br><span class="line">cluster = tf.train.ClusterSpec(&#123;<span class="string">"worker"</span>: [<span class="string">"10.1.1.1:2222"</span>, <span class="string">"10.1.1.2:3333"</span>]&#125;)</span><br><span class="line">server = tf.train.Server(cluster, job_name=<span class="string">"local"</span>, task_index=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#在主机(10.1.1.2)上,实际运行以下代码</span></span><br><span class="line">cluster = tf.train.ClusterSpec(&#123;<span class="string">"worker"</span>: [<span class="string">"10.1.1.1:2222"</span>, <span class="string">"10.1.1.2:3333"</span>]&#125;)</span><br><span class="line">server = tf.train.Server(cluster, job_name=<span class="string">"local"</span>, task_index=<span class="number">1</span>)<span class="number">1234567</span></span><br></pre></td></tr></table></figure>
<p><code>tf.trian.Server</code>干了些什么呢?<br>首先,一个<code>tf.train.Server</code>包含了: 本地设备(GPUs,CPUs)的集合,可以连接到到其它<code>task</code>的<code>ip:port</code>(存储在<code>cluster</code>中), 还有一个<code>session target</code>用来执行分布操作.还有最重要的一点就是,它创建了一个服务器,监听<code>port</code>端口,如果有数据传过来,他就会在本地执行(启动<code>session target</code>,调用本地设备执行运算),然后结果返回给调用者.</p>
<p>我们继续来写我们的<code>task</code>代码:在你的<code>model</code>中指定分布式设备</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.device(<span class="string">"/job:ps/task:0"</span>):</span><br><span class="line">  weights_1 = tf.Variable(...)</span><br><span class="line">  biases_1 = tf.Variable(...)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.device(<span class="string">"/job:ps/task:1"</span>):</span><br><span class="line">  weights_2 = tf.Variable(...)</span><br><span class="line">  biases_2 = tf.Variable(...)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.device(<span class="string">"/job:worker/task:0"</span>): <span class="comment">#映射到主机(10.1.1.1)上去执行</span></span><br><span class="line">  input, labels = ...</span><br><span class="line">  layer_1 = tf.nn.relu(tf.matmul(input, weights_1) + biases_1)</span><br><span class="line">  logits = tf.nn.relu(tf.matmul(layer_1, weights_2) + biases_2)</span><br><span class="line"><span class="keyword">with</span> tf.device(<span class="string">"/job:worker/task:1"</span>): <span class="comment">#映射到主机(10.1.1.2)上去执行</span></span><br><span class="line">  input, labels = ...</span><br><span class="line">  layer_1 = tf.nn.relu(tf.matmul(input, weights_1) + biases_1)</span><br><span class="line">  logits = tf.nn.relu(tf.matmul(layer_1, weights_2) + biases_2)</span><br><span class="line">  <span class="comment"># ...</span></span><br><span class="line">  train_op = ...</span><br><span class="line"><span class="keyword">with</span> tf.Session(<span class="string">"grpc://10.1.1.2:3333"</span>) <span class="keyword">as</span> sess:<span class="comment">#在主机(10.1.1.2)上执行run</span></span><br><span class="line">  <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10000</span>):</span><br><span class="line">    sess.run(train_op)</span><br></pre></td></tr></table></figure>
<p><code>with tf.Session(&quot;grpc://..&quot;)</code>是指定<code>gprc://..</code>为<code>master</code>,<code>master</code>将<code>op</code>分发给对应的<code>task</code></p>
<h3 id="使用In-graph-replication还是Between-graph-replication"><a href="#使用In-graph-replication还是Between-graph-replication" class="headerlink" title="使用In-graph replication还是Between-graph replication"></a>使用In-graph replication还是Between-graph replication</h3><p><code>In-graph replication</code>:一个<code>client</code>(显示调用tf::Session的进程),将里面的<code>参数</code>和<code>ops</code>指定给对应的<code>job</code>去完成.数据分发只由一个<code>client</code>完成.</p>
<p><code>Between-graph replication</code>:下面的代码就是这种形式,有很多独立的<code>client</code>,各个<code>client</code>构建了相同的<code>graph</code>(包含参数,通过使用<code>tf.train.replica_device_setter</code>,将这些参数映射到<code>ps_server</code>上.)</p>
<h3 id="同步训练-还是异步训练"><a href="#同步训练-还是异步训练" class="headerlink" title="同步训练,还是异步训练"></a>同步训练,还是异步训练</h3><p><code>Synchronous training</code>:在这种方式中,每个<code>graph</code>的副本读取相同的<code>parameter</code>的值,并行的计算<code>gradients</code>,然后将所有计算完的<code>gradients</code>放在一起处理.<code>Tensorlfow</code>提供了函数(<code>tf.train.SyncReplicasOptimizer</code>)来处理这个问题(在<code>Between-graph replication</code>情况下),在<code>In-graph replication</code>将所有的<code>gradients</code>平均就可以了</p>
<p><code>Asynchronous training</code>:自己计算完<code>gradient</code>就去更新<code>paramenter</code>,不同<code>replica</code>之间不会去协调进度</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ol>
<li><a href="http://blog.csdn.net/u012436149/article/details/53140869" target="_blank" rel="noopener">tensorflow学习笔记(十九):分布式Tensorflow</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/25/请假分类实验数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/25/请假分类实验数据/" itemprop="url">请假分类实验数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-25T12:02:07+08:00">
                2018-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/machine-learning/" itemprop="url" rel="index">
                    <span itemprop="name">machine learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Feature-Bank-Of-Word-Feature"><a href="#Feature-Bank-Of-Word-Feature" class="headerlink" title="Feature:Bank Of Word Feature"></a>Feature:Bank Of Word Feature</h3><h4 id="分类器1-否定分类器"><a href="#分类器1-否定分类器" class="headerlink" title="分类器1(否定分类器)"></a>分类器1(否定分类器)</h4><p>模型：逻辑回归</p>
<p>特征选择：bank of word</p>
<p>验证方法：k折交叉验证(k=5)</p>
<table>
<thead>
<tr>
<th>C</th>
<th>Average Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>0.99 (+/- 0.00)</td>
</tr>
</tbody>
</table>
<h4 id="分类器2-肯定分类器"><a href="#分类器2-肯定分类器" class="headerlink" title="分类器2(肯定分类器)"></a>分类器2(肯定分类器)</h4><p>模型：逻辑回归</p>
<p>验证方法：k折交叉验证(k=5)</p>
<table>
<thead>
<tr>
<th>C</th>
<th>Average Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>0.78 (+/- 0.05)</td>
</tr>
<tr>
<td>2.50</td>
<td>0.79 (+/- 0.03)</td>
</tr>
<tr>
<td>2</td>
<td>0.79 (+/- 0.03)</td>
</tr>
</tbody>
</table>
<h4 id="分类器2-肯定分类器-1"><a href="#分类器2-肯定分类器-1" class="headerlink" title="分类器2(肯定分类器)"></a>分类器2(肯定分类器)</h4><p>模型：SVM</p>
<p>验证方法：k折交叉验证(k=5)</p>
<table>
<thead>
<tr>
<th>C</th>
<th>kernel</th>
<th>Average Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>2.00</td>
<td>linear</td>
<td>0.78 (+/- 0.04)</td>
</tr>
<tr>
<td>105.00</td>
<td>poly</td>
<td>0.68 (+/- 0.02)</td>
</tr>
<tr>
<td>31.00</td>
<td>rbf</td>
<td>0.81 (+/- 0.04)</td>
</tr>
<tr>
<td>19.00</td>
<td>sigmoid</td>
<td>0.75 (+/- 0.03)</td>
</tr>
</tbody>
</table>
<h3 id="Feature-Bank-Of-word-Average-Word2Vec"><a href="#Feature-Bank-Of-word-Average-Word2Vec" class="headerlink" title="Feature:Bank Of word + Average Word2Vec"></a>Feature:Bank Of word + Average Word2Vec</h3><h4 id="分类器2-肯定分类器-2"><a href="#分类器2-肯定分类器-2" class="headerlink" title="分类器2(肯定分类器)"></a>分类器2(肯定分类器)</h4><p>模型：逻辑回归</p>
<p>验证方法：k折交叉验证(k=5)</p>
<table>
<thead>
<tr>
<th>C</th>
<th>Average Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>2.00</td>
<td>0.79 (+/- 0.03)</td>
</tr>
</tbody>
</table>
<h4 id="分类器2-肯定分类器-3"><a href="#分类器2-肯定分类器-3" class="headerlink" title="分类器2(肯定分类器)"></a>分类器2(肯定分类器)</h4><p>模型：SVM</p>
<p>验证方法：k折交叉验证(k=5)</p>
<table>
<thead>
<tr>
<th>C</th>
<th>kernel</th>
<th>Average Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>2.00</td>
<td>linear</td>
<td>0.78 (+/- 0.04)</td>
</tr>
<tr>
<td>183.00</td>
<td>poly</td>
<td>0.68 (+/- 0.03)</td>
</tr>
<tr>
<td>50.00</td>
<td>rbf</td>
<td>0.80 (+/- 0.03)</td>
</tr>
<tr>
<td>17.00</td>
<td>sigmoid</td>
<td>0.76 (+/- 0.01)</td>
</tr>
</tbody>
</table>
<h3 id="Feature-Normalized-Bank-Of-word-Average-Word2Vec"><a href="#Feature-Normalized-Bank-Of-word-Average-Word2Vec" class="headerlink" title="Feature:Normalized Bank Of word + Average Word2Vec"></a>Feature:Normalized Bank Of word + Average Word2Vec</h3><h4 id="分类器2-肯定分类器-4"><a href="#分类器2-肯定分类器-4" class="headerlink" title="分类器2(肯定分类器)"></a>分类器2(肯定分类器)</h4><p>模型：逻辑回归</p>
<p>验证方法：k折交叉验证(k=5)</p>
<table>
<thead>
<tr>
<th>C</th>
<th>Average Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>78.00</td>
<td>0.80 (+/- 0.03)</td>
</tr>
</tbody>
</table>
<h4 id="分类器2-肯定分类器-5"><a href="#分类器2-肯定分类器-5" class="headerlink" title="分类器2(肯定分类器)"></a>分类器2(肯定分类器)</h4><p>模型：SVM</p>
<p>验证方法：k折交叉验证(k=5)</p>
<table>
<thead>
<tr>
<th>C</th>
<th>kernel</th>
<th>Average Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>37.00</td>
<td>linear</td>
<td>0.81 (+/- 0.02)</td>
</tr>
<tr>
<td>1.00</td>
<td>poly</td>
<td>0.64 (+/- 0.00)</td>
</tr>
<tr>
<td>179.00</td>
<td>rbf</td>
<td>0.65 (+/- 0.01)</td>
</tr>
<tr>
<td>1.00</td>
<td>sigmoid</td>
<td>0.64 (+/- 0.00)</td>
</tr>
</tbody>
</table>
<h3 id="Feature-Bank-Of-word-Average-Word2Vec-Special-Features"><a href="#Feature-Bank-Of-word-Average-Word2Vec-Special-Features" class="headerlink" title="Feature:Bank Of word + Average Word2Vec + Special Features"></a>Feature:Bank Of word + Average Word2Vec + Special Features</h3><p>分类器2(肯定分类器)</p>
<p>模型：SVM</p>
<p>验证方法：k折交叉验证(k=5)</p>
<table>
<thead>
<tr>
<th>C</th>
<th>kernel</th>
<th>Average Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.00</td>
<td>linear</td>
<td>0.77 (+/- 0.02)</td>
</tr>
<tr>
<td>188.00</td>
<td>poly</td>
<td>0.68 (+/- 0.03)</td>
</tr>
<tr>
<td>44.00</td>
<td>rbf</td>
<td>0.80 (+/- 0.03)</td>
</tr>
<tr>
<td>17.00</td>
<td>sigmoid</td>
<td>0.76 (+/- 0.01)</td>
</tr>
</tbody>
</table>
<h3 id="停用词"><a href="#停用词" class="headerlink" title="停用词"></a>停用词</h3><table>
<thead>
<tr>
<th>有无停用词</th>
<th>Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td>有</td>
<td>0.8989</td>
</tr>
<tr>
<td>无</td>
<td>0.8996</td>
</tr>
</tbody>
</table>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/25/逻辑回归与svm的比较/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/25/逻辑回归与svm的比较/" itemprop="url">逻辑回归与svm的比较</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-25T11:18:54+08:00">
                2018-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/machine-learning/" itemprop="url" rel="index">
                    <span itemprop="name">machine learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>两种方法都是常见的分类算法，其中心思想都是增加对分类影响较大的数据点的分值，减少与分类关系较小的数据点的分值。SVM的处理方法是只考虑support vectors，也就是和分类最相关的少数点，去学习分类器。而逻辑回归通过非线性映射，大大减小了离分类平面较远的点的分值，相对提升了与分类最相关的数据点的分值。两者的根本目的都是一样的。</p>
<h3 id="比较："><a href="#比较：" class="headerlink" title="比较："></a>比较：</h3><ol>
<li>速度：lr的训练速度远远快与svm</li>
<li>LR给出了后验概率，SVM只有01分类，没有后验概率</li>
<li>LR采用logistic损失（误差平方和损失），SVM采用合页（Hinge）损失。（损失函数是二者的本质区别）</li>
<li>LR对异常值敏感；SVM对异常值不敏感，泛华能力强，分类效果好。</li>
<li>在训练集较小时，SVM较适用，而LR需要较多的样本。</li>
<li>LR模型找到的那个超平面，是尽量让所有点都远离他，而SVM寻找的那个超平面，是只让最靠近中间分割线的那些点尽量远离，即只用到那些支持向量的样本。</li>
<li>对非线性问题的处理方式不同，LR主要靠特征构造，必须组合交叉特征，特征离散化；SVM也可以这样，还可以通过kernel，kernel很强大。</li>
<li>LR相对来说模型更简单，好理解，实现起来，特别是大规模线性分类时比较方便。而SVM的理解和优化相对来说复杂一些。但是SVM的理论基础更加牢固，有一套结构化风险最小化的理论基础.</li>
</ol>
<p>SVM优缺点：</p>
<p>优：泛化错误率低，计算开销不大，结果易解释。</p>
<p>缺：SVM对参数调节和核函数的选择敏感，原始分类器不加修改仅适用于处理二类问题。</p>
<p>Logistic优缺点：</p>
<p>优：计算代价不高，易于理解和实现。</p>
<p>缺：容易欠拟合，分类精度可能不高。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ol>
<li><a href="http://blog.csdn.net/u011204487/article/details/60590070" target="_blank" rel="noopener">逻辑回归和SVM的比较</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/25/sklearn交叉验证/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/25/sklearn交叉验证/" itemprop="url">sklearn交叉验证</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-25T10:40:21+08:00">
                2018-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sklearn/" itemprop="url" rel="index">
                    <span itemprop="name">sklearn</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="交叉验证概述"><a href="#交叉验证概述" class="headerlink" title="交叉验证概述"></a>交叉验证概述</h3><p>进行模型验证的一个重要目的是要选出一个最合适的模型，对于监督学习而言，我们希望模型对于未知数据的泛化能力强，所以就需要模型验证这一过程来体现不同的模型对于未知数据的表现效果。</p>
<p>最先我们用训练准确度（用全部数据进行训练和测试）来衡量模型的表现，这种方法会导致模型过拟合；为了解决这一问题，我们将所有数据分成训练集和测试集两部分，我们用训练集进行模型训练，得到的模型再用测试集来衡量模型的预测表现能力，这种度量方式叫测试准确度，这种方式可以有效避免过拟合。</p>
<p>测试准确度的一个缺点是其样本准确度是一个高方差估计（high varianceestimate），所以该样本准确度会依赖不同的测试集，其表现效果不尽相同。</p>
<h5 id="K折交叉验证"><a href="#K折交叉验证" class="headerlink" title="K折交叉验证"></a>K折交叉验证</h5><ol>
<li>将数据集平均分割成K个等份</li>
<li>使用1份数据作为测试数据，其余作为训练数据</li>
<li>计算测试准确率</li>
<li>使用不同的测试集，重复2、3步骤</li>
<li>对<strong>测试准确率做平均</strong>，作为对未知数据预测准确率的估计</li>
</ol>
<center><img src="/img/posts/cross_validation" alt=""></center>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/25/sklearn数据集划分/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/25/sklearn数据集划分/" itemprop="url">KFold，StratifiedKFold k折交叉切分</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-25T10:31:33+08:00">
                2018-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sklearn/" itemprop="url" rel="index">
                    <span itemprop="name">sklearn</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>StratifiedKFold用法类似Kfold，但是他是分层采样，确保训练集，测试集中各类别样本的比例与原始数据集中相同。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> KFold,StratifiedKFold</span><br><span class="line"></span><br><span class="line">X=np.array([</span><br><span class="line">    [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],</span><br><span class="line">    [<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>],</span><br><span class="line">    [<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>],</span><br><span class="line">    [<span class="number">31</span>,<span class="number">32</span>,<span class="number">33</span>,<span class="number">34</span>],</span><br><span class="line">    [<span class="number">41</span>,<span class="number">42</span>,<span class="number">43</span>,<span class="number">44</span>],</span><br><span class="line">    [<span class="number">51</span>,<span class="number">52</span>,<span class="number">53</span>,<span class="number">54</span>],</span><br><span class="line">    [<span class="number">61</span>,<span class="number">62</span>,<span class="number">63</span>,<span class="number">64</span>],</span><br><span class="line">    [<span class="number">71</span>,<span class="number">72</span>,<span class="number">73</span>,<span class="number">74</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">y=np.array([<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>])</span><br><span class="line"><span class="comment">#n_folds这个参数没有，引入的包不同，</span></span><br><span class="line">floder = KFold(n_splits=<span class="number">4</span>,random_state=<span class="number">0</span>,shuffle=<span class="keyword">False</span>)</span><br><span class="line">sfolder = StratifiedKFold(n_splits=<span class="number">4</span>,random_state=<span class="number">0</span>,shuffle=<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> train, test <span class="keyword">in</span> sfolder.split(X,y):</span><br><span class="line">    print(<span class="string">'Train: %s | test: %s'</span> % (train, test))</span><br><span class="line">    print(<span class="string">" "</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> train, test <span class="keyword">in</span> floder.split(X,y):</span><br><span class="line">    print(<span class="string">'Train: %s | test: %s'</span> % (train, test))</span><br><span class="line">    print(<span class="string">" "</span>)</span><br></pre></td></tr></table></figure>
<h5 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h5><ol>
<li>​</li>
</ol>
<p>Train: [1 3 4 5 6 7] | test: [0 2]</p>
<p>Train: [0 2 4 5 6 7] | test: [1 3]</p>
<p>Train: [0 1 2 3 5 7] | test: [4 6]</p>
<p>Train: [0 1 2 3 4 6] | test: [5 7]</p>
<ol>
<li>​</li>
</ol>
<p>Train: [2 3 4 5 6 7] | test: [0 1]</p>
<p>Train: [0 1 4 5 6 7] | test: [2 3]</p>
<p>Train: [0 1 2 3 6 7] | test: [4 5]</p>
<p>Train: [0 1 2 3 4 5] | test: [6 7]</p>
<p><strong>分析：</strong>可以看到StratifiedKFold 分层采样交叉切分，确保训练集，测试集中各类别样本的比例与原始数据集中相同。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ol>
<li><a href="http://blog.csdn.net/wqh_jingsong/article/details/77896449" target="_blank" rel="noopener">KFold，StratifiedKFold k折交叉切分</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/22/深度学习分词/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/22/深度学习分词/" itemprop="url">深度学习中防止过拟合的方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-22T22:19:47+08:00">
                2018-01-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/deep-learning-分词/" itemprop="url" rel="index">
                    <span itemprop="name">deep learning,分词</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>深度学习分词主要有两种方法，biLSTM+CRF和IDCNN+CRF。对于这两种方法，后面的CRF层是一致的，不同的就在于前面的biLSTM和IDCNN层。</p>
<h3 id="IDCNN"><a href="#IDCNN" class="headerlink" title="IDCNN"></a>IDCNN</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://changzeng.github.io/year/01/22/linux小常识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changzeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geek Liao">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/year/01/22/linux小常识/" itemprop="url">linux小常识</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-22T16:48:50+08:00">
                2018-01-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="VIRT"><a href="#VIRT" class="headerlink" title="VIRT"></a>VIRT</h3><p>VIRT stands for the virtual size of a process, which is the sum of memory it is actually using, memory it has mapped into itself (for instance the video card’s RAM for the X server), files on disk that have been mapped into it (most notably shared libraries), and memory shared with other processes. VIRT represents how much memory the program is able to access at the present moment.</p>
<h3 id="RES"><a href="#RES" class="headerlink" title="RES"></a>RES</h3><p>RES stands for the resident size, which is an accurate representation of how much actual physical memory a process is consuming. (This also corresponds directly to the %MEM column.) This will virtually always be less than the VIRT size, since most programs depend on the C library.</p>
<h3 id="SHR"><a href="#SHR" class="headerlink" title="SHR"></a>SHR</h3><p>SHR indicates how much of the VIRT size is actually sharable (memory or libraries). In the case of libraries, it does not necessarily mean that the entire library is resident. For example, if a program only uses a few functions in a library, the whole library is mapped and will be counted in VIRT and SHR, but only the parts of the library file containing the functions being used will actually be loaded in and be counted under RES.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="changzeng" />
          <p class="site-author-name" itemprop="name">changzeng</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">71</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">Kategorien</span>
              
            </div>
          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">changzeng</span>
</div>


<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
